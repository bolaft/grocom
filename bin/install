<?php

require_once 'bootstrap.php';

echo 'Mise à jour des librairies...' . PHP_EOL;
echo exec('php ' . ROOT_PATH . 'composer.phar update');

echo 'Changement des droits de app/cache et app/logs...' . PHP_EOL;
echo exec('sudo chmod -R 777 ' . APPLICATION_PATH . '/cache');
echo exec('sudo chmod -R 777 ' . APPLICATION_PATH . '/logs');

echo 'Création de la base de données...' . PHP_EOL;
echo exec('php ' . APPLICATION_PATH . 'console doctrine:database:create');

echo 'Suppression des tables...' . PHP_EOL;
echo exec('php ' . APPLICATION_PATH . 'console doctrine:schema:drop --force');

echo 'Création des tables...' . PHP_EOL;
echo exec('php ' . APPLICATION_PATH . 'console doctrine:schema:create');

echo 'Chargement des fixtures : "y" pour continuer, "n" pour annuler' . PHP_EOL;
echo exec('php ' . APPLICATION_PATH . 'console doctrine:fixtures:load');

echo 'Installation terminée !' . PHP_EOL;